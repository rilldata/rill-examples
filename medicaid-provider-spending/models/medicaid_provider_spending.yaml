type: model
description: >
  Raw Medicaid provider spending data from CMS. Each row is a billing provider + servicing provider +
  HCPCS code + month combination with claim counts, beneficiary counts, and payment totals.
materialize: true

timeout: 10m

sql: |
  SELECT
    BILLING_PROVIDER_NPI_NUM as billing_provider_npi,
    SERVICING_PROVIDER_NPI_NUM as servicing_provider_npi,
    HCPCS_CODE as hcpcs_code,
    STRPTIME(CLAIM_FROM_MONTH, '%Y-%m')::DATE as claim_month,
    TOTAL_UNIQUE_BENEFICIARIES as total_unique_beneficiaries,
    TOTAL_CLAIMS as total_claims,
    TOTAL_PAID as total_paid
  FROM read_parquet('https://stopendataprod.blob.core.windows.net/datasets/medicaid-provider-spending/2026-02-09/medicaid-provider-spending.parquet')
  {{ if dev }} LIMIT 500000 {{ end }}
