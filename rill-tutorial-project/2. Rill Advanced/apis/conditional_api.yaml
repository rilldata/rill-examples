# API YAML
# Reference documentation: https://docs.rilldata.com/reference/project-files/apis
# Test your API endpoint at http://localhost:9009/v1/instances/default/api/conditional_api?date=2024-01-01


type: api
name: conditional_api

#metrics_sql: |

sql: |
  SELECT SUM("net_line_changes")
    {{ if ( .user.admin ) }} , author_name {{ end }} 
    FROM advanced_commits___model WHERE author_date > '{{ .args.date }}' 
    {{ if ( .user.admin ) }} group by author_name {{ end }}