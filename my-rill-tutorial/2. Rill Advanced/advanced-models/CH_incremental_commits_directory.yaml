type: model

incremental: true
refresh:
    cron: "0 8 * * *"

partitions:
  glob:
    path: gs://rilldata-public/github-analytics/Clickhouse/2025/*/*
    partition: directory
  
sql: |
  SELECT * 
     FROM read_parquet('gs://rilldata-public/{{ .partition.path }}/commits_*.parquet') 
    WHERE '{{ .partition.path }}' IS NOT NULL


output:
  connector: duckdb
  incremental_strategy: append