# Metrics view YAML
# Reference documentation: https://docs.rilldata.com/reference/project-files/dashboards
# This file was generated using AI.

version: 1
type: metrics_view

display_name: Automotive Logistics 2000-2025 Model Metrics
model: automotive_logistics_2000_2025_model
timeseries: ship_date

first_month_of_year: 9

dimensions:
  - name: shipment_id
    display_name: Shipment Id
    column: shipment_id
  - name: origin_country
    display_name: Origin Country
    column: origin_country
  - name: currency
    display_name: Currency
    column: currency
  - name: vehicle_type
    display_name: Vehicle Type
    column: vehicle_type
  - name: status
    display_name: Status
    column: status
  - name: port_of_entry
    display_name: Port Of Entry
    column: port_of_entry
  - name: country
    display_name: Country
    column: country


  - expression: CAST(EXTRACT(YEAR FROM ship_date) AS VARCHAR) || '-Q' ||  CAST(((EXTRACT(MONTH FROM ship_date) - 1) / 3 + 1) AS INTEGER)
    name: quarter
    description: dynamic date filternig
  - expression: CAST(EXTRACT(YEAR FROM ship_date - interval 8 months) AS VARCHAR) || '-Q' ||  CAST(((EXTRACT(MONTH FROM ship_date - interval 8 months) - 1) / 3 + 1) AS INTEGER)
    name: shifted_quarter
    description: dynamic date filternig
  - expression: ship_date + interval 10 year
    name: date_modified 
    description: dynamic date filternig
  - expression: ship_date - interval 8 months
    name: actual_date
    description: dynamic date filternig

  - expression: strftime(ship_date, '%B %Y')
    name: date_modified_string
    description: dynamic date filternig
  - expression: strftime(ship_date, '%m-%B %Y')
    name: date_modified_num_string
    description: dynamic date filternig

measures:
  - name: total_quantity_shipped_measure
    display_name: Total Quantity Shipped
    expression: SUM(quantity)
    description: Total quantity of vehicles shipped.
    format_preset: humanize
  - name: average_unit_price_measure
    display_name: Average Unit Price
    expression: AVG(unit_price)
    description: Average price per unit of the vehicles shipped.
    format_preset: humanize
  - name: sum_usd_price_measure
    display_name: Total USD Shipments
    expression: SUM(usd_price)
    description: Average price in USD for the vehicles shipped.
    format_preset: currency_usd
    valid_percent_of_total: false
  - name: total_usd_value_measure
    display_name: Total USD Value
    expression: SUM(usd_price * quantity)
    description: Total value of shipments in USD.
    format_preset: currency_usd
    valid_percent_of_total: false
  - name: average_exchange_rate_measure
    display_name: Average Exchange Rate
    expression: AVG(exchange_rate)
    description: Average exchange rate applied to the shipments.
    format_preset: humanize
